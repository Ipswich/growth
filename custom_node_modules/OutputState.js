var mappings = require('./Mappings.js');
var moment = require('moment');

module.exports = class OutputState {
  constructor() {
    return (async () => {
      this.data = [];
      //Get outputs
      let outputMappings = await mappings.getOutputMappings();
      //map initial values
      for (let i = 0; i < outputMappings.length; i++){
        this.data[i] = {};
        this.data[i].outputID = outputMappings[i].outputID;
        this.data[i].outputType = outputMappings[i].outputType;
        this.data[i].scheduleState = 2;
        this.data[i].interruptTime = null;
      }
      return this;
    })();
  }

  setOutputScheduleState(outputID, scheduleState) {
    for(let i = 0; i < this.data.length; i++){
      if(this.data[i].outputID == outputID){
        this.data[i].scheduleState = scheduleState;
      }
    }
  }

  setOutputDelayTime(outputID, interruptTime) {
    for(let i = 0; i < this.data.length; i++){
      if(this.data[i].outputID == outputID){
        this.interruptTime = interruptTime;
      }
    }
  }

  getOutputState(){
    return this.data;
  }

}
